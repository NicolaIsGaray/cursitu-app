<!-- Vista de Materias -->
<main>
  <!-- Sidebar Reactivo por Rol -->
  <app-sidebar [currentRole]="currentRole"></app-sidebar>

  <div class="main-content">
    <!-- Header -->
    <div class="top-header">
      <button class="btn btn-outline" (click)="goToHome()">Volver al Inicio</button>
      <h1>Materias</h1>
      <div class="user-profile">
        <div class="user-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle>
          </svg>
          <span class="status-dot active"></span>
        </div>
      </div>
    </div>

    <!-- Filtro de búsqueda -->
    <div class="filter-bar">
      <input type="text" [(ngModel)]="searchTerm" placeholder="Buscar materia..." class="search-input">
    </div>

    <!-- Dropdown principal "Materias" -->
    <div class="subjects-dropdown">
      <!-- Contenido cuando está expandido -->
      <div class="subjects-content">
        <!-- Grid de tarjetas de materias -->
        <div class="subjects-grid">
          <div class="subject-card" *ngFor="let subject of filteredSubjects" [style.background-color]="subject.color" (click)="onSubjectClick(subject)">
            <div class="subject-placeholder"></div>
            <div class="subject-info">
              <h3>{{ subject.nombre }}</h3>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Contenedor de detalles de la materia seleccionada -->
    <div class="subject-details-container" *ngIf="selectedSubject && subjectDetails">
      <!-- Título y Descripción -->
      <div class="details-header">
        <h2>{{ selectedSubject.nombre }}</h2>
        <p>{{ subjectDetails.descripcion }}</p>
      </div>

      <!-- Programa Analítico -->
      <div class="program-card">
        <h4>Programa Analítico</h4>
        <pre>{{ subjectDetails.programaAnalitico }}</pre>
      </div>

      <!-- Módulos/Clases -->
      <div class="modules-section">
        <h4>Clases</h4>
        <div class="modules-list">
          <div class="module-item" *ngFor="let clase of subjectDetails.clases">
            <div class="dropdown-header" (click)="toggleClase(clase)">
              <span>{{ clase.nombre }}</span>
              <svg class="dropdown-arrow" [class.expanded]="clase.expanded" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6 9 12 15 18 9"></polyline>
              </svg>
            </div>
            <div class="module-content" *ngIf="clase.expanded">
              <p>Contenido de la {{ clase.nombre }}...</p>
              <ul>
                <li>Material de lectura</li>
                <li>Video de la clase</li>
                <li>Actividades</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
</main>
